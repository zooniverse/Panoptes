<script>
  var DEFAULT_PRIVACY_TEXT = "I have read and agreed to the";
  var DEFAULT_EMAIL_TEXT = "Email (required)";
  var DEFAULT_SUBSCRIPTION_TEXT = "It’s okay to send me email every once in a while.";

  $(function () {
    $(document).ready(function() {
      $("#privacy_text").text(DEFAULT_PRIVACY_TEXT);
      $("#agreement_text").text(DEFAULT_SUBSCRIPTION_TEXT);
      $("#email_text label").text(DEFAULT_EMAIL_TEXT);
    });
    $("#under_age").change(function() {
      if ($("#under_age").is(':checked')) {
        $("#privacy_text").text("I confirm I am the parent/guardian and give permission for my child to register by providing my email address as the main contact address. Both I and my child understand and agree to the");
        $("#agreement_text").text("If you agree, we will periodically send email promoting new research-related projects or other information relating to our research. We will not use your contact information for commercial purposes.");
        $("#anonymous_text").text("Don't use your real name");
        $("#email_text label").text("Parent/Guardian's Email (required)");
      } else {
        $("#privacy_text").text(DEFAULT_PRIVACY_TEXT);
        $("#agreement_text").text(DEFAULT_SUBSCRIPTION_TEXT);
        $("#anonymous_text").text("");
        $("#email_text label").text(DEFAULT_EMAIL_TEXT);
      }
      });
    });
</script>

<div class="form-container panel panel-default">
  <div class="panel-body">
    <h2>Create account</h2>

    <%= form_for(resource, as: resource_name, url: registration_path(resource_name)) do |f| %>

      <div class="checkbox">
          <label for="under_age">
            <input name="under_age" id="under_age" type="checkbox"/>
            If you are under 16 years old, tick this box and complete the form with your parent/guardian.
          </label>
      </div>

      <div class="form-group <%= "has-errors" if resource.errors[:login].present? %>">
        <%= f.label :login, "Username (required)" %><small class="errored"><%= resource.errors[:login].join(', ')%></small><br />
        <%= f.text_field :login, autofocus: true, required: true, class: 'form-control' %>
        <small id="anonymous_text"></small>
      </div>

      <div class="form-group <%= "has-errors" if resource.errors[:credited_name].present? %>">
        <%= f.label :credited_name, "Real Name (optional)" %><small class="errored"><%= resource.errors[:credited_name].join(', ')%></small><br />
        <%= f.text_field :credited_name, class: 'form-control' %>
        <small>We’ll use this to give you credit in scientific papers, posters, etc</small>
      </div>

      <div class="form-group <%= "has-errors" if resource.errors[:email].present? %>" id="email_text">
        <%= f.label :email%><small class="errored"><%= resource.errors[:email].join(', ')%></small><br />
        <%= f.email_field :email, required: true, class: 'form-control' %>
      </div>

      <div class="form-group" >
        <%= f.label :password, "Password (required)"%><small class="errored"><%= resource.errors[:password].join(', ')%></small><br />
        <%= f.password_field :password, autocomplete: "off", required: true, class: 'form-control' %>

        <%= f.label :password_confirmation, "Password confirmation (required)" %><small class="errored"><%= resource.errors[:password_confirmation].join(', ')%></small><br />
        <%= f.password_field :password_confirmation, autocomplete: "off", required: true, class: 'form-control' %>
      </div>

      <div class="checkbox" >
        <label for="privacy">
          <input name="privacy" id="privacy" type="checkbox" />
          <span id="privacy_text"></span>
          <a href="https://www.zooniverse.org/privacy">Privacy Policy</a>
        </label>
      </div>

        <div class="checkbox">
          <%= f.label :global_email_communication do %>
            <%= f.check_box :global_email_communication, checked: true %>
            <span id="agreement_text"></span>
          <% end %>
        </div>

        <div class="checkbox">
          <%= f.label :beta_email_communication do %>
            <%= f.check_box :beta_email_communication, checked: false %>
            I’d like to help test new projects, and be emailed when they’re available.
          <% end %>
        </div>

      <%= f.submit "Create account", class: 'btn btn-primary' %>
    <% end %>
  </div>

  <div class="panel-footer">
    <%= render "devise/shared/links" %>
  </div>
</div>
